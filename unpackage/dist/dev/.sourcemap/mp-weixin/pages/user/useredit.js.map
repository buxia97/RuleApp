{"version":3,"sources":["uni-app:///main.js","webpack:///E:/APPpro/voss/RuleAppRro/pages/user/useredit.vue?7b04","webpack:///E:/APPpro/voss/RuleAppRro/pages/user/useredit.vue?c3d6","webpack:///E:/APPpro/voss/RuleAppRro/pages/user/useredit.vue?2c6d","webpack:///E:/APPpro/voss/RuleAppRro/pages/user/useredit.vue?6df2","uni-app:///pages/user/useredit.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","StatusBar","CustomBar","NavBar","AppStyle","uid","name","screenName","password","repassword","mail","phone","url","avatar","avatarNew","introduce","modalName","token","onPullDownRefresh","onShow","that","console","onLoad","methods","back","uni","delta","showModal","hideModal","validatePassword","userStatus","header","method","dataType","success","userInfo","localStorage","fail","title","icon","validateString","userEdit","duration","position","setTimeout","clearTimeout","toEmail","toPhone","toAddress","toPay","toBind","toGravatar","toAvatar","avatarUpload","base64ToPath","then","filePath","formData","catch","isValidString"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,iBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;;;AAGvD;AACsK;AACtK,gBAAgB,6KAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAonB,CAAgB,knBAAG,EAAC,C;;;;;;;;;;;;;;;;;;ACuHxoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAIA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAC;MAEAC;IACA;EACA;EACAC;IACA;EAEA;EACAC;IACA;IAMAC;IAEA;MACA;MACAA;IACA;MACAC;IACA;EAEA;EACAC;IACA;IAEAF;EAEA;EACAG;IACAC;MACAC;QACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;QACA;QACAb;MACA;MACAG;QAEAR;QACAZ;UACA;QACA;QACA+B;UACA;QACA;QACAC;QACAC;QACAC;UACA;YACAd;YACAA;YACAA;YACAA;YACAA;YACAA;YACAA;YACAA;YACAA;YACA;cAEA;cACA;gBACAA;cACA;gBACAA;cACA;cACA;gBACAe;cACA;cACA;gBACAA;cACA;cACA;gBACAA;cACA;cACA;gBACAA;cACA;cACA;gBACAA;cACA;cACAC;cACA;cACA;cACA;YAEA;UAEA;QACA;;QACAC;UACAZ;YACAa;YACAC;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACAxB;MACA;MACA;QACA;UACAQ;YACAa;YACAC;YACAG;YACAC;UACA;UACA;QACA;QACA;UACAlB;YACAa;YACAC;YACAG;YACAC;UACA;UACA;QACA;MAEA;MACA;QACAlB;UACAa;UACAC;UACAG;UACAC;QACA;QACA;MACA;MACA;QACAtC;QACAC;QACAC;QACAC;QACAO;QACAH;MACA;MACA;QACAZ;MACA;MACAyB;QACAa;MACA;MACAlB;QAEAR;QACAZ;UACA;UACA;QACA;QACA+B;UACA;QACA;QACAC;QACAC;QACAC;UACA;UACAU;YACAnB;UACA;UACAA;YACAa;YACAC;UACA;UACA;YACA;YACA;cACAH;cACAA;cACA;gBACAX;kBACAb;gBACA;gBACAiC;cACA;YACA;cACA;cACAV;cACAA;cACAA;cACA;gBACAA;cACA;cACAf;cACAgB;cACA;YACA;UAEA;QACA;;QACAC;UACAO;YACAnB;UACA;UACAA;YACAa;YACAC;UACA;UACAd;QACA;MACA;IACA;IACAqB;MACA;MAEArB;QACAb;MACA;IACA;IACAmC;MACA;MAEAtB;QACAb;MACA;IACA;IACAoC;MACA;MAEAvB;QACAb;MACA;IACA;IACAqC;MACA;MAEAxB;QACAb;MACA;IACA;IACAsC;MACA;MAEAzB;QACAb;MACA;IACA;IACAuC;MACA;MACA/B;MACA;IAOA;IACAgC,+BAYA;IACAC;MAEA;MACA;MACA;QACA;QACApC;MACA;MACAqC,qBACAC;QACA;QACA;UACA3C;UACA4C;UACA;UACA;UACA;UACAlD;UACAmD;YACA;UACA;UACAvB;YACAU;cACAnB;YACA;YAEA;YACA;;YAGA;cACA;cACA;cACA;cACA;cACAL;cACAA;cACAgB;cACAhB;cACA;YAEA;cACAK;gBACAa;gBACAC;cACA;YACA;UACA;UAAAF;YACAO;cACAnB;YACA;UACA;QAGA;MACA,GACAiC;QACArC;MACA;IACA;IACAsC;MACA;IACA;EACA;AACA;AAAA,2B","file":"pages/user/useredit.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/uni-stat/dist/uni-stat.es.js';\nimport Vue from 'vue'\nimport Page from './pages/user/useredit.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./useredit.vue?vue&type=template&id=1b19edf0&\"\nvar renderjs\nimport script from \"./useredit.vue?vue&type=script&lang=js&\"\nexport * from \"./useredit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/user/useredit.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./useredit.vue?vue&type=template&id=1b19edf0&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./useredit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./useredit.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"user\" :class=\"$store.state.AppStyle\">\n\t\t<view class=\"header\" :style=\"[{height:CustomBar + 'px'}]\">\n\t\t\t<view class=\"cu-bar bg-white\" :style=\"{'height': CustomBar + 'px','padding-top':StatusBar + 'px'}\">\n\t\t\t\t<view class=\"action\" @tap=\"back\">\n\t\t\t\t\t<text class=\"cuIcon-back\"></text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"content text-bold\" :style=\"[{top:StatusBar + 'px'}]\">\n\t\t\t\t\t个人设置\n\t\t\t\t</view>\n\t\t\t\t<!--  #ifdef H5 || APP-PLUS -->\n\t\t\t\t<view class=\"action\" @tap=\"userEdit\">\n\t\t\t\t\t<button class=\"cu-btn round bg-blue\">保存</button>\n\t\t\t\t</view>\n\t\t\t\t<!--  #endif -->\n\t\t\t</view>\n\t\t</view>\n\t\t<view :style=\"[{padding:NavBar + 'px 10px 0px 10px'}]\"></view>\n\t\t\n\t\t<form>\n\t\t\t<view class=\"user-edit-header margin-top\">\n\t\t\t\t<image :src=\"avatar\"></image>\n\t\t\t\t<!--  #ifdef H5 || APP-PLUS -->\n\t\t\t\t<!-- <text class=\"cu-btn bg-blue radius\" @tap=\"showModal\" data-target=\"DialogModal1\">设置头像</text> -->\n\t\t\t\t<text class=\"cu-btn bg-gradual-blue radius\" @tap=\"toAvatar\" >设置头像</text>\n\t\t\t\t<!--  #endif -->\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t<view class=\"title\">用户名</view>\n\t\t\t\t<input name=\"input\" disabled=\"disabled\" :value=\"name\"></input>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t<view class=\"title\">昵称</view>\n\t\t\t\t<input placeholder=\"请输入昵称\" name=\"input\" v-model=\"screenName\"></input>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t<view class=\"title\">邮箱</view>\n\t\t\t\t<input placeholder=\"未设置\" disabled=\"disabled\" name=\"input\" :value=\"mail\"></input>\n\t\t\t\t<view class=\"text-blue\" @tap=\"toEmail\">修改</view>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t<view class=\"title\">手机号</view>\n\t\t\t\t<input placeholder=\"未设置\" disabled=\"disabled\" name=\"input\" :value=\"phone\"></input>\n\t\t\t\t<view class=\"text-blue\" @tap=\"toPhone\">修改</view>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t<view class=\"title\">网址</view>\n\t\t\t\t<input placeholder=\"请输入网址\" name=\"input\" v-model=\"url\"></input>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group align-start\">\n\t\t\t\t<view class=\"title\">个人简介</view>\n\t\t\t\t<textarea v-model=\"introduce\"  placeholder=\"输入个人简介\"></textarea>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t<view class=\"title\">密码</view>\n\t\t\t\t<input placeholder=\"请输入密码,不填则不修改\" v-model=\"password\" name=\"input\"></input>\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t<view class=\"title\">确认密码</view>\n\t\t\t\t<input placeholder=\"请再次输入密码\" v-model=\"repassword\" name=\"input\"></input>\n\t\t\t</view>\n\t\t</form>\n\t\t<!--  #ifdef H5 || APP-PLUS -->\n\t\t<view class=\"cu-list menu\">\n\t\t\t<view class=\"cu-item margin-top\" @tap=\"toBind\">\n\t\t\t\t<view class=\"content\">\n\t\t\t\t\t<text>社会化登陆绑定</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"action\">\n\t\t\t\t\t<text class=\"cuIcon-right\"></text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"cu-item\" @tap=\"toAddress\">\n\t\t\t\t<view class=\"content\">\n\t\t\t\t\t<text>收货地址设置</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"action\">\n\t\t\t\t\t<text class=\"cuIcon-right\"></text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"cu-item\" @tap=\"toPay\">\n\t\t\t\t<view class=\"content\">\n\t\t\t\t\t<text>账户设置</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"action\">\n\t\t\t\t\t<text class=\"cuIcon-right\"></text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!--  #endif -->\n\t\t<view class=\"cu-modal\" :class=\"modalName=='DialogModal1'?'show':''\">\n\t\t\t<view class=\"cu-dialog\">\n\t\t\t\t<view class=\"cu-bar bg-white justify-end\">\n\t\t\t\t\t<view class=\"content\">设置头像</view>\n\t\t\t\t\t<view class=\"action\" @tap=\"hideModal\">\n\t\t\t\t\t\t<text class=\"cuIcon-close text-red\"></text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"padding-xl text-left\">\n\t\t\t\t\t<view>Gravatar是全球最大的头像库，属于Wordpress旗下。它广泛应用于国内外各类网站和程序，包括知名的Github。在Gravatar通过您的邮箱注册用户，并设置头像后，您在所有支持Gravatar的网站使用邮箱，都会显示您的头像。</view>\n\t\t\t\t\t<view>或者，您可以将将邮箱设置成QQ邮箱，将自动获取您的QQ头像。</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cu-bar bg-white justify-end\">\n\t\t\t\t\t<view class=\"action\">\n\t\t\t\t\t\t<button class=\"cu-btn bg-green margin-left\" @tap=\"toGravatar\">前往Gravatar</button>\n\t\t\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!--  #ifdef MP -->\n\t\t<view class=\"post-update bg-blue\" @tap=\"userEdit\">\n\t\t\t<text class=\"cuIcon-upload\"></text>\n\t\t</view>\n\t\t<!--  #endif -->\n\t</view>\n</template>\n\n<script>\n\timport { localStorage } from '../../js_sdk/mp-storage/mp-storage/index.js'\n\t// #ifdef H5 || APP-PLUS \n\timport { pathToBase64, base64ToPath } from '../../js_sdk/mmmm-image-tools/index.js'\n\t// #endif\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tStatusBar: this.StatusBar,\n\t\t\t\tCustomBar: this.CustomBar,\n\t\t\t\tNavBar:this.StatusBar +  this.CustomBar,\n\t\t\tAppStyle:this.$store.state.AppStyle,\n\t\t\t\t\n\t\t\t\tuid:0,\n\t\t\t\tname:'',\n\t\t\t\tscreenName:'',\n\t\t\t\tpassword:'',\n\t\t\t\trepassword:'',\n\t\t\t\tmail:'',\n\t\t\t\tphone:\"\",\n\t\t\t\turl:'',\n\t\t\t\tavatar:\"\",\n\t\t\t\tavatarNew:\"\",\n\t\t\t\tintroduce:\"\",\n\t\t\t\t\n\t\t\t\tmodalName: null,\n\t\t\t\t\n\t\t\t\ttoken:'',\n\t\t\t}\n\t\t},\n\t\tonPullDownRefresh(){\n\t\t\tvar that = this;\n\t\t\t\n\t\t},\n\t\tonShow(){\n\t\t\tvar that = this;\n\t\t\t// #ifdef APP-PLUS\n\t\t\t\n\t\t\t//plus.navigator.setStatusBarStyle(\"dark\")\n\t\t\t// #endif\n\t\t\t\n\t\t\tthat.userStatus();\n\t\t\t\n\t\t\tif(localStorage.getItem('toAvatar')){\n\t\t\t\tvar toAvatar = JSON.parse(localStorage.getItem('toAvatar'));\n\t\t\t\tthat.avatarUpload(toAvatar.dataUrl);\n\t\t\t}else{\n\t\t\t\tconsole.log(\"没有头像缓存\")\n\t\t\t}\n\t\t\t\n\t\t},\n\t\tonLoad() {\n\t\t\tvar that = this;\n\t\t\t// #ifdef APP-PLUS || MP\n\t\t\tthat.NavBar = this.CustomBar;\n\t\t\t// #endif\n\t\t},\n\t\tmethods: {\n\t\t\tback(){\n\t\t\t\tuni.navigateBack({\n\t\t\t\t\tdelta: 1\n\t\t\t\t});\n\t\t\t},\n\t\t\tshowModal(e) {\n\t\t\t\tthis.modalName = e.currentTarget.dataset.target\n\t\t\t},\n\t\t\thideModal(e) {\n\t\t\t\tthis.modalName = null\n\t\t\t},\n\t\t\tvalidatePassword(password) {\n\t\t\t  const regex = /^(?=.*[A-Za-z])(?=.*\\d)(?=.*[`~!@#$%^&*()_+<>?:\"{},.\\/\\\\;'[\\]])[A-Za-z\\d`~!@#$%^&*()_+<>?:\"{},.\\/\\\\;'[\\]]{8,}$/;\n\t\t\t  return regex.test(password);\n\t\t\t},\n\n\t\t\tuserStatus() {\n\t\t\t\tvar that = this;\n\t\t\t\tvar token = \"\";\n\t\t\t\tif(localStorage.getItem('userinfo')){\n\t\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\n\t\t\t\t\ttoken=userInfo.token;\n\t\t\t\t}\n\t\t\t\tthat.$Net.request({\n\t\t\t\t\t\n\t\t\t\t\turl: that.$API.userStatus(),\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t\"token\":token\n\t\t\t\t\t},\n\t\t\t\t\theader:{\n\t\t\t\t\t\t'Content-Type':'application/x-www-form-urlencoded'\n\t\t\t\t\t},\n\t\t\t\t\tmethod: \"get\",\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tif(res.data.code==1){\n\t\t\t\t\t\t\tthat.uid=res.data.data.uid;\n\t\t\t\t\t\t\tthat.screenName=res.data.data.screenName;\n\t\t\t\t\t\t\tthat.name=res.data.data.name;\n\t\t\t\t\t\t\tthat.mail=res.data.data.mail;\n\t\t\t\t\t\t\tthat.url=res.data.data.url;\n\t\t\t\t\t\t\tthat.token=res.data.data.token;\n\t\t\t\t\t\t\tthat.avatar=res.data.data.avatar;\n\t\t\t\t\t\t\tthat.introduce = res.data.data.introduce;\n\t\t\t\t\t\t\tthat.phone = res.data.data.phone;\n\t\t\t\t\t\t\tif(localStorage.getItem('userinfo')){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\n\t\t\t\t\t\t\t\tif(userInfo.screenName){\n\t\t\t\t\t\t\t\t\tthat.screenName = userInfo.screenName;\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tthat.screenName = userInfo.name;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(res.data.data.customize){\n\t\t\t\t\t\t\t\t\tuserInfo.customize = res.data.data.customize;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(res.data.data.lv){\n\t\t\t\t\t\t\t\t\tuserInfo.lv = res.data.data.lv;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(res.data.data.isvip){\n\t\t\t\t\t\t\t\t\tuserInfo.isvip = res.data.data.isvip;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(res.data.data.vip){\n\t\t\t\t\t\t\t\t\tuserInfo.vip = res.data.data.vip;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(res.data.data.experience){\n\t\t\t\t\t\t\t\t\tuserInfo.experience = res.data.data.experience;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlocalStorage.setItem('userinfo',JSON.stringify(userInfo));\n\t\t\t\t\t\t\t\t// if(res.data.data.avatar){\n\t\t\t\t\t\t\t\t// \tthat.userInfo = res.data.data.avatar;\n\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: function(res) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: \"网络开小差了哦\",\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tvalidateString(str) {\n\t\t\t  // 判断是否包含空格或中文空格\n\t\t\t  if (/\\s|　/.test(str)) {\n\t\t\t    return false;\n\t\t\t  }\n\t\t\t  // 判断是否只包含空格\n\t\t\t  if (/^\\s+$/.test(str)) {\n\t\t\t    return false;\n\t\t\t  }\n\t\t\t  return true;\n\t\t\t},\n\t\t\tuserEdit() {\n\t\t\t\tvar that = this;\n\t\t\t\tvar token = \"\";\n\t\t\t\tif(localStorage.getItem('userinfo')){\n\t\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\n\t\t\t\t\ttoken=userInfo.token;\n\t\t\t\t}\n\t\t\t\tif (that.password != \"\") {\n\t\t\t\t\tif(!that.validatePassword(that.password)){\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle:\"密码必须包含字母、数字和特殊符号，且长度必须大于8\",\n\t\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\tposition:'bottom',\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t\tif (that.password != that.repassword) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t    title:\"两次密码不一致\",\n\t\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\tposition:'bottom',\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif(that.isValidString(that.screenName)){\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t    title:\"昵称不能包含空格\",\n\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\tposition:'bottom',\n\t\t\t\t\t});\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tvar data = {\n\t\t\t\t\tuid:that.uid,\n\t\t\t\t\tname:that.name,\n\t\t\t\t\tscreenName:that.screenName,\n\t\t\t\t\tpassword:that.password,\n\t\t\t\t\tintroduce:that.introduce,\n\t\t\t\t\turl:that.url,\n\t\t\t\t}\n\t\t\t\tif(that.avatarNew!=''){\n\t\t\t\t\tdata.avatar = that.avatarNew;\n\t\t\t\t}\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: \"加载中\"\n\t\t\t\t});\n\t\t\t\tthat.$Net.request({\n\t\t\t\t\t\n\t\t\t\t\turl: that.$API.userEdit(),\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t\"params\":JSON.stringify(that.$API.removeObjectEmptyKey(data)),\n\t\t\t\t\t\t\"token\":token\n\t\t\t\t\t},\n\t\t\t\t\theader:{\n\t\t\t\t\t\t'Content-Type':'application/x-www-form-urlencoded'\n\t\t\t\t\t},\n\t\t\t\t\tmethod: \"get\",\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\t//console.log(JSON.stringify(res))\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: res.data.msg,\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tif(res.data.code==1){\n\t\t\t\t\t\t\t//保存用户信息\n\t\t\t\t\t\t\tif(that.password!=\"\"){\n\t\t\t\t\t\t\t\tlocalStorage.removeItem('userinfo');\n\t\t\t\t\t\t\t\tlocalStorage.removeItem('token');\n\t\t\t\t\t\t\t\tvar timer = setTimeout(function() {\n\t\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\t\turl: '/pages/home/index'\r\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tclearTimeout('timer')\n\t\t\t\t\t\t\t\t}, 1000)\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\n\t\t\t\t\t\t\t\tuserInfo.screenName=that.screenName;\n\t\t\t\t\t\t\t\tuserInfo.url=that.url;\n\t\t\t\t\t\t\t\tuserInfo.introduce = that.introduce;\n\t\t\t\t\t\t\t\tif(that.avatarNew!=''){\n\t\t\t\t\t\t\t\t\tuserInfo.avatar = that.avatarNew;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthat.avatarNew = '';\n\t\t\t\t\t\t\t\tlocalStorage.setItem('userinfo',JSON.stringify(userInfo));\n\t\t\t\t\t\t\t\t//that.getCacheInfo();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: function(res) {\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: \"网络开小差了哦\",\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tuni.stopPullDownRefresh()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\ttoEmail(){\n\t\t\t\tvar that = this;\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/mailedit'\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoPhone(){\n\t\t\t\tvar that = this;\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/phoneedit'\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoAddress(){\n\t\t\t\tvar that = this;\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/address'\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoPay(){\n\t\t\t\tvar that = this;\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/pay'\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoBind(){\n\t\t\t\tvar that = this;\n\t\t\t\t\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/userbind'\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoGravatar(){\n\t\t\t\tvar that = this;\n\t\t\t\tthat.hideModal();\n\t\t\t\tvar url = \"https://cn.gravatar.com/\";\n\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\tplus.runtime.openURL(url) \n\t\t\t\t// #endif\n\t\t\t\t// #ifdef H5\n\t\t\t\twindow.open(url)\n\t\t\t\t// #endif\n\t\t\t},\n\t\t\ttoAvatar(){\n\t\t\t\t// #ifdef APP-PLUS || H5\n\t\t\t\tconst that = this;\n\t\t\t\t  uni.navigateTo({\n\t\t\t\t\turl: \"../../uni_modules/buuug7-img-cropper/pages/cropper\",\n\t\t\t\t\tevents: {\n\t\t\t\t\t  imgCropped(event) {\n\t\t\t\t\t\tconsole.log(event);\n\t\t\t\t\t  },\n\t\t\t\t\t},\n\t\t\t\t  });\n\t\t\t\t// #endif\n\t\t\t},\n\t\t\tavatarUpload(base64){\n\t\t\t\t\n\t\t\t\tvar that = this;\n\t\t\t\tvar token = \"\";\n\t\t\t\tif(localStorage.getItem('userinfo')){\n\t\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\n\t\t\t\t\ttoken=userInfo.token;\n\t\t\t\t}\n\t\t\t\tbase64ToPath(base64)\n\t\t\t\t  .then(path => {\n\t\t\t\t\tvar file = path;\n\t\t\t\t\tconst uploadTask = uni.uploadFile({\n\t\t\t\t\t  url : that.$API.upload(),\n\t\t\t\t\t  filePath:file,\n\t\t\t\t\t //  header: {\n\t\t\t\t\t\t// \"Content-Type\": \"multipart/form-data\",\n\t\t\t\t\t // },\n\t\t\t\t\t  name: 'file',\n\t\t\t\t\t  formData: {\n\t\t\t\t\t   'token': token\n\t\t\t\t\t  },\n\t\t\t\t\t  success: function (uploadFileRes) {\n\t\t\t\t\t\t  setTimeout(function () {\n\t\t\t\t\t\t  \tuni.hideLoading();\n\t\t\t\t\t\t  }, 1000);\n\t\t\t\t\t\t  \n\t\t\t\t\t\t\tvar data = JSON.parse(uploadFileRes.data);\n\t\t\t\t\t\t\t//var data = uploadFileRes.data;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(data.code==1){\n\t\t\t\t\t\t\t\t// uni.showToast({\n\t\t\t\t\t\t\t\t// \ttitle: data.msg,\n\t\t\t\t\t\t\t\t// \ticon: 'none'\n\t\t\t\t\t\t\t\t// })\n\t\t\t\t\t\t\t\tthat.avatar = data.data.url;\n\t\t\t\t\t\t\t\tthat.avatarNew = data.data.url;\n\t\t\t\t\t\t\t\tlocalStorage.removeItem('toAvatar');\n\t\t\t\t\t\t\t\tthat.userEdit();\n\t\t\t\t\t\t\t\t//console.log(that.avatar)\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: \"头像上传失败，请检查接口\",\n\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},fail:function(){\n\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t   \n\t\t\t\t\t});\n\t\t\t\t  })\n\t\t\t\t  .catch(error => {\n\t\t\t\t\tconsole.error(\"失败\"+error)\n\t\t\t\t  })\n\t\t\t},\n\t\t\tisValidString(str) {\n\t\t\t  return /\\s/g.test(str);\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":""}